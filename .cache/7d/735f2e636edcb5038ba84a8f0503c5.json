{"id":"js/app.js","dependencies":[{"name":"C:\\dev\\company_search\\package.json","includedInParent":true,"mtime":1604774585961},{"name":"@babel/runtime/regenerator","parent":"C:\\dev\\company_search\\src\\js\\app.js","resolved":"C:\\dev\\company_search\\node_modules\\@babel\\runtime\\regenerator\\index.js"},{"name":"@babel/runtime/helpers/asyncToGenerator","parent":"C:\\dev\\company_search\\src\\js\\app.js","resolved":"C:\\dev\\company_search\\node_modules\\@babel\\runtime\\helpers\\asyncToGenerator.js"}],"generated":{"js":"\"use strict\";\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// DATA CONTROLLER\nvar searchController = function () {\n  var _search = {};\n  return {\n    search: function () {\n      var _search2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(query) {\n        var baseURL, result, data;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _search.query = query;\n                baseURL = \"https://data.gov.au/data/api/3/action/datastore_search?resource_id=cb7e4eb5-ed46-4c6c-97a0-4532f4479b7d&q=\";\n                _context.prev = 2;\n                _context.next = 5;\n                return fetch(baseURL + query);\n\n              case 5:\n                result = _context.sent;\n                _context.next = 8;\n                return result.json();\n\n              case 8:\n                data = _context.sent;\n                console.log(data.result);\n                _search.results = data.result.records;\n                return _context.abrupt(\"return\", data.result.records);\n\n              case 14:\n                _context.prev = 14;\n                _context.t0 = _context[\"catch\"](2);\n                alert(\"There was an error with your search\");\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[2, 14]]);\n      }));\n\n      function search(_x) {\n        return _search2.apply(this, arguments);\n      }\n\n      return search;\n    }(),\n    sortResultsByDate: function sortResultsByDate(results) {\n      var oldestToNewest = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      return results.sort(function (cur, next) {\n        var curDate = cur[\"Date of Registration\"];\n        var nextDate = next[\"Date of Registration\"]; // date object for current result\n\n        var a = {\n          day: Number(curDate.slice(0, 2)),\n          month: Number(curDate.slice(3, 5)),\n          year: Number(curDate.slice(6))\n        }; // date object for next result\n\n        var b = {\n          day: Number(nextDate.slice(0, 2)),\n          month: Number(nextDate.slice(3, 5)),\n          year: Number(nextDate.slice(6))\n        };\n        var sortCondition;\n\n        if (oldestToNewest) {\n          sortCondition = a.year > b.year || a.year === b.year && a.month > b.month || a.year === b.year && a.month === b.month && a.day > b.day;\n        } else {\n          sortCondition = a.year < b.year || a.year === b.year && a.month < b.month || a.year === b.year && a.month === b.month && a.day < b.day;\n        }\n\n        return sortCondition ? 1 : -1;\n      });\n    }\n  };\n}(); // UI CONTROLLER\n\n\nvar UIController = function () {\n  var DOMStrings = {\n    searchForm: \"#searchForm\",\n    searchInput: \"#searchInput\",\n    searchButton: \"#searchButton\",\n    resultsList: \"#resultsList\",\n    spinLoader: \"#spinLoader\"\n  };\n\n  var loader = function loader() {\n    var el = document.createElement('div');\n    el.classList.add('spinLoader');\n    return el;\n  };\n\n  var card = {\n    // - Company Name\n    // - Current Name\n    skeleton: function skeleton() {\n      var card = document.createElement('div');\n      card.classList.add('result-card');\n      var cardTop = document.createElement('div');\n      cardTop.classList.add('card-top');\n      var cardBottom = document.createElement('div');\n      cardBottom.classList.add('card-bottom');\n      card.appendChild(cardTop);\n      card.appendChild(cardBottom);\n      return card;\n    },\n    top: function top(record) {\n      var HTML = '';\n\n      if (record[\"Company Name\"] !== null && record[\"Company Name\"].length) {\n        HTML += \"<h2 class=\\\"comp-name\\\">\".concat(record[\"Company Name\"], \" \").concat(card.googleIcon(record), \"</h2>\");\n      }\n\n      if (record[\"Current Name\"] !== null && record[\"Current Name\"].length) {\n        HTML += \"<small>Current Name:</small>\";\n        HTML += \"<h4 class=\\\"curr-name\\\">\".concat(record[\"Current Name\"], \"</h4>\");\n      }\n\n      return HTML;\n    },\n    detailsText: function detailsText(record, field) {\n      var HTML = '';\n\n      if (record[field] && record[field] !== '0') {\n        HTML += \"<div class=\\\"info-group\\\"><div class=\\\"field\\\">\".concat(field, \"</div><div class=\\\"value\\\">\").concat(record[field], \"</div></div>\");\n      }\n\n      return HTML;\n    },\n    googleIcon: function googleIcon(record) {\n      return \"<a target=\\\"_blank\\\" style=\\\"margin-left: auto;\\\" href=\\\"https://google.com/search?q=\".concat(record[\"Company Name\"], \"\\\"><img class=\\\"google-icon\\\" src=\\\"img/googleSearchIcon.png\\\" height=40 width=40></a>\");\n    }\n  };\n  return {\n    getDOMStrings: function getDOMStrings() {\n      return DOMStrings;\n    },\n    clearInput: function clearInput() {\n      document.querySelector(DOMStrings.searchInput).value = \"\";\n    },\n    getInput: function getInput() {\n      return document.querySelector(DOMStrings.searchInput).value;\n    },\n    setPlaceholder: function setPlaceholder(value) {\n      document.querySelector(DOMStrings.searchInput).placeholder = value;\n    },\n    toggleLoader: function toggleLoader() {\n      var resList = document.querySelector(DOMStrings.resultsList);\n      var spinner = document.querySelector('.spinLoader');\n\n      if (resList.contains(spinner)) {\n        // remove loader\n        resList.removeChild(spinner);\n      } else {\n        // add loader\n        spinner = loader();\n        resList.appendChild(spinner);\n      }\n    },\n    renderResults: function renderResults(results) {\n      var resultsList = document.querySelector(DOMStrings.resultsList);\n      var infoKeys = [\"Date of Registration\", \"ABN\", \"ACN\", \"Current Name Start Date\", \"Previous State of Registration\", \"Status\", \"Class\", \"Sub Class\", \"Type\"];\n      resultsList.innerHTML = \"\";\n      results.forEach(function (result) {\n        var shell = card.skeleton();\n        var cardTop = shell.querySelector('.card-top');\n        var cardBottom = shell.querySelector('.card-bottom');\n        cardTop.innerHTML = card.top(result);\n        infoKeys.forEach(function (key) {\n          cardBottom.innerHTML += card.detailsText(result, key);\n        });\n        resultsList.insertAdjacentElement('beforeend', shell);\n      });\n    },\n    clearResults: function clearResults() {\n      document.querySelector(DOMStrings.resultsList).innerHTML = '';\n    },\n    toTop: function toTop() {\n      window.scrollTo(0, 0);\n    }\n  };\n}(); // APP CONTROLLER\n\n\nvar controller = function (searchCtrl, UICtrl) {\n  var DOM = UICtrl.getDOMStrings();\n\n  var setupEventListeners = function setupEventListeners() {\n    document.querySelector(DOM.searchForm).addEventListener(\"submit\", /*#__PURE__*/function () {\n      var _ref = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2(e) {\n        var input, results, sortedResults;\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                e.preventDefault();\n                input = UICtrl.getInput();\n\n                if (!input) {\n                  _context2.next = 14;\n                  break;\n                }\n\n                UICtrl.toTop();\n                UICtrl.clearResults();\n                UICtrl.toggleLoader();\n                _context2.next = 8;\n                return searchCtrl.search(input);\n\n              case 8:\n                results = _context2.sent;\n                UICtrl.setPlaceholder(input);\n                UICtrl.clearInput();\n                sortedResults = searchCtrl.sortResultsByDate(results);\n                UICtrl.toggleLoader();\n                UICtrl.renderResults(sortedResults);\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x2) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  };\n\n  return {\n    init: function init() {\n      setupEventListeners();\n    }\n  };\n}(searchController, UIController);\n\ncontroller.init();"},"sourceMaps":null,"error":null,"hash":"64ac6c2008302994db19834f2bbf29e6","cacheData":{"env":{}}}